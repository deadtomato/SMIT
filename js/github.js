const body=document.querySelector("body"),form=modal.querySelector(".modal__form"),resetFormBtn=modal.querySelector(".modal__reset"),fieldset=form.querySelector(".modal__fieldset"),fields=form.querySelectorAll(".modal__input"),submitBtn=form.querySelector(".modal__btn"),userFirstName=form.querySelector("#firstNameField"),userLastName=form.querySelector("#lastNameField"),REPO_NAME="cathotel",TIMEOUT=3e3,URL="https://api.github.com/repos/papatomatoe/cathotel/generate",OWNER="papatomatoe",METHOD="POST",IS_PRIVATE=!1,Headers={Authorization:"Token c47ea763c4ac9b929ef98cbfe986211233741bd5",Accept:"application/vnd.github.baptiste-preview+json"},Messages={SUCCESS:"Ваш репозиторий готов!",WAITING:"Секундочку...",ERROR:"Произошла ошибка, попробуйте повторить позже...",INPUT_ERROR:"Необходимо заполнить все поля!"},FieldStyles={NORMAL:{NAME:"normal",STYLE:"border: 1px solid #dedde2 ; box-shadow: none;"},WARNING:{NAME:"warning",STYLE:"border-color: transparent; box-shadow: 0 0 0 2px tomato;"}},FieldsetStyles={ENABLE:"opacity: 1;",DISABLE:"opacity: 0.5;"};function createAnchor(e){const t=document.createElement("div");t.classList.add("modal-anchor");const a=document.createElement("a");a.classList.add("message--anchor"),a.href=e,a.textContent=Messages.SUCCESS,t.appendChild(a),body.appendChild(t)}const createMessage=e=>{const t=document.createElement("p");t.innerText=e,t.classList.add("message"),modal.appendChild(t)},setFieldsColor=e=>{let t;switch(e){case FieldStyles.NORMAL.NAME:t=FieldStyles.NORMAL.STYLE;break;case FieldStyles.WARNING.NAME:t=FieldStyles.WARNING.STYLE}fields.forEach(e=>e.style=t)},makeFieldsDisable=()=>{fieldset.disabled||(fieldset.disabled=!0,fieldset.style=FieldsetStyles.DISABLE),submitBtn.disabled=!0},createWarning=e=>{createMessage(e),setFieldsColor(FieldStyles.WARNING.NAME)},createWaiting=e=>{createMessage(e),makeFieldsDisable()},clear=()=>{const e=modal.querySelector(".message");e&&(e.remove(),setFieldsColor(FieldStyles.NORMAL.NAME)),fieldset.disabled&&(fieldset.disabled=!1,fieldset.style=FieldsetStyles.ENABLE),submitBtn.disabled=!1},modalClose=()=>{modal.classList.remove("modal--show")},generateID=()=>Math.floor(99999*Math.random()),createRepoFromPrivateTemp=async e=>{e.preventDefault(),clear();const t=new Date;if(userFirstName.value&&userLastName.value){createMessage(Messages.WAITING),makeFieldsDisable();const e={name:`${t.getDate()}-${t.getMonth()<9?"0"+t.getMonth():t.getMonth()}-${t.getFullYear()}--${Math.floor(99999*Math.random())}--cathotel`,owner:OWNER,description:`${userFirstName.value} ${userLastName.value}`,private:!1},a=await fetch(URL,{method:"POST",headers:Headers,body:JSON.stringify(e)});if(!a.ok)return clear(),createMessage(Messages.ERROR),makeFieldsDisable(),void setTimeout(clear,3e3);{const e=(await a.json()).html_url;modal.classList.remove("modal--show"),createAnchor(e)}}else createWarning(Messages.INPUT_ERROR),setTimeout(clear,3e3)};form.addEventListener("submit",createRepoFromPrivateTemp),fields.forEach(e=>{e.addEventListener("input",clear)}),resetFormBtn.addEventListener("click",clear);